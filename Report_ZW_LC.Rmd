---
title: "2023_DAIE_GCA_ZW_LC"
author: "Mark (Zak) White & Lee Cunningham"
date: "19th November, 2018"
output: html_notebook
//toc: true
---

![Test Image](/Users/leecu/Desktop/MScY1/Data Analytics/kitkat.png)
# Install from CRAN (Installing Tidyverse)
install.packages("tidyverse")

library("tidyverse")
require("tidyverse")
# Cleaning the data
Control <- read.csv("D:\\Games Dev\\Data-Analytics-group-CA-MW-LC\\GROUP_2_2023_GCA_RESULTS_CONTROL.csv")
Experimental <- read.csv("D:\\Games Dev\\Data-Analytics-group-CA-MW-LC\\GROUP_2_2023_GCA_RESULTS_EXPERIMENTAL.csv")

View(Experimental)
glimpse(Experimental)
unique(Control$gender)
unique(Experimental$gender)

#replacing the F in the control group to female as it is a safe assumption
Control$gender[Control$gender== "F"] <- "female"
Control
view(Control)
#Replacing the "Male" with male in Experimental
Experimental$gender[Experimental$gender== "Male"] <- "male"
View(Experimental)
unique(Control$gender)
unique(Experimental$gender)

#getting some mean data from variables
mean(Control$pretrial_GAD)
mean(Experimental$pretrial_GAD)
mean(Control$posttrial_GAD)
mean(Experimental$posttrial_GAD)

##searching for incomplete data Reference https://www.youtube.com/watch?v=sV5lwAJ7vnQ 17:05
Control %>%
  select(patientID, gender, pretrial_GAD, pretrial_STAI, posttrial_GAD, posttrial_STAI) %>%
  filter(!complete.cases(.))
  
Experimental %>%
  select(patientID, gender, pretrial_GAD, pretrial_STAI, posttrial_GAD, posttrial_STAI) %>%
  filter(!complete.cases(.))


#This is the R way of finding duplicates
Control[duplicated(Control), ]
Experimental[duplicated(Experimental), ]

#This is the tidyverse way of finding distinct entries Reference: https://www.youtube.com/watch?v=sV5lwAJ7vnQ 25:00
Control %>%
  distinct()

Experimental %>%
  distinct()
  
# Checking for Outliers
filter(Control, !Control$pretrial_GAD >= 0 | !Control$pretrial_GAD <= 21)
boxplot(Control$pretrial_GAD)
Q1 <- quantile(Control$pretrial_GAD, .25)
Q3 <- quantile(Control$pretrial_GAD, .75)
IQR <- IQR(Control$pretrial_GAD)
pretrialGAD_Control <- subset(Control, Control$pretrial_GAD> (Q1 - 1.5*IQR) & Control$pretrial_GAD< (Q3 + 1.5*IQR))
dim(pretrialGAD_Control)
boxplot(pretrialGAD_Control$pretrial_GAD)



filter(Control, !Control$posttrial_GAD >= 0 | !Control$posttrial_GAD <= 21)
boxplot(Control$posttrial_GAD)
Q1 <- quantile(Control$posttrial_GAD, .25)
Q3 <- quantile(Control$posttrial_GAD, .75)
IQR <- IQR(Control$posttrial_GAD)
posttrialGAD_Control <- subset(Control, Control$posttrial_GAD> (Q1 - 1.5*IQR) & Control$posttrial_GAD< (Q3 + 1.5*IQR))
dim(posttrialGAD_Control)
boxplot(posttrialGAD_Control$posttrial_GAD)



boxplot(Control$pretrial_STAI)
filter(Control, !Control$pretrial_STAI >= 20 | !Control$pretrial_STAI <= 80)



filter(Control, !Control$posttrial_STAI >= 20 | !Control$posttrial_STAI <= 80)
boxplot(Control$posttrial_STAI)
Q1 <- quantile(Control$posttrial_STAI, .25)
Q3 <- quantile(Control$posttrial_STAI, .75)
IQR <- IQR(Control$posttrial_STAI)
posttrialSTAI_Control <- subset(Control, Control$posttrial_STAI> (Q1 - 1.5*IQR) & Control$posttrial_STAI< (Q3 + 1.5*IQR))
dim(posttrialSTAI_Control)
boxplot(posttrialSTAI_Control$posttrial_STAI)



boxplot(Experimental$pretrial_GAD)
filter(Experimental, !Experimental$pretrial_GAD >= 0 | !Experimental$pretrial_GAD <= 21)



boxplot(Experimental$posttrial_GAD)
filter(Experimental, !Experimental$posttrial_GAD >= 0 | !Experimental$posttrial_GAD <= 21)



boxplot(Experimental$pretrial_STAI)
filter(Experimental, !Experimental$pretrial_STAI >= 20 | !Experimental$pretrial_STAI <= 80)



filter(Experimental, !Experimental$posttrial_STAI >= 20 | !Experimental$posttrial_STAI <= 80)
boxplot(Experimental$posttrial_STAI)
Q1 <- quantile(Experimental$posttrial_STAI, .25)
Q3 <- quantile(Experimental$posttrial_STAI, .75)
IQR <- IQR(Experimental$posttrial_STAI)
posttrialSTAI_Experimental <- subset(Experimental, Experimental$posttrial_STAI> (Q1 - 1.5*IQR) & Experimental$posttrial_STAI< (Q3 + 1.5*IQR))
dim(posttrialSTAI_Experimental)
boxplot(posttrialSTAI_Experimental$posttrial_STAI)

<!-- REFERENCE: https://financetrain.com/remove-outliers-r -->

### Merging New DataSets Into Base Dataset

merge(Experimental, posttrialSTAI_Experimental, by="posttrial_STAI")

nControl <- merge(Control, pretrialGAD_Control, keep=pretrial_GAD, obs=90)
nnControl <- merge(nControl, posttrialGAD_Control, keep=posttrial_GAD, obs=90)
clean_Control <- merge(nnControl, posttrialSTAI_Control, keep=posttrial_STAI, obs=90)
view(clean_Control)

clean_Experimental <- merge(Experimental, posttrialSTAI_Experimental, keep=posttrial_STAI, obs=90)
view(clean_Experimental)

### **Abstract**

##### **Aim and Rationale**
##### **Participants and Setting**
##### **Experiment Design**
##### **Results Gathering**
##### **Findings/ Implications**

### **Introduction**

##### **Topic and Context**
##### **Rationale**
##### **Hypothesis**

### **Method**

##### **Participants**
##### **Design**
##### **Materials**
##### **Procedure**

### **Results**

##### **Descriptive Statistics**
##### **Inferential Statistics**
##### **Statistical Tests**
##### **Magnitude and Direction of Results**

### **Discussion**

##### **Outline Findings and Relation To The Hypothesis**
##### **Limitations (if confounding variables are clearly identified by your group)**

### **References**

## ---------------------------------------------------------------------------------------------

### **Abstract** (2.5M)
##### **Aim and Rationale**
* The aim of the experiment was to find whether the use of VR-based therapy would have a positive effect on patients who are undergoing treatment for Generalized Anxiety Disorder (GAD).
* Virtual Reality offers immersive experiences that have the ability to simulate real-world scenarios in a controlled environment. VR allows for desensitization to certain scenarios by exposing patients to situations that can trigger anxiety. 
Post-Traumatic Stress Disorder, Acrophobia and Social Anxiety Disorders can be treated through the use of VR exposure therapy (VRET). The integration of VR into therapy practices, showcases the potential it has to make positive changes to treatments for anxiety disorder.
            
##### **Participants and Setting**
* There was **180** participants in total for this study. They were **randomly sampled** from the clinic's client list. **96 were Male** and **84 were Female**. They were randomly assigned into the two groups.
* **Control (Traditional CBT, no VR) (M = 48, F = 42)**
* **Experimental (VR-Based Therapy) (M = 48, F = 42)**
* All participants were between the ago of **18-40** years old.

##### **Experiment Design**
* The two groups proceeded to go to 12 weeks of treatment with a therapist in 50 minute sessions. During the treatment sessions, the patients either experienced the traditional CBT or underwent the VR-Based therapy.

##### **Results Gathering**
* In this study, the participants were asked to self-report the severity of the anxiety they were feeling. The measurements used were the 'State-Trait Anxiety Inventory' and 'Generalised Anxiety Disorder 7 Item Scale'. Both use a range of 0 - 10.

##### **Findings/ Implications**
* FILL THIS OUT - LEE

### 4 - **Introduction** (15M)
##### **Topic and Context**
* The amount of people who suffer from anxiety disorders worldwide is approximately 301 million, World Health Organisation, 2019.
* Anxiety disorders are mental disorders which can include a variety of feelings such as anxiety and fear. These feelings can cause individuals to experience a 'racing heart' and/ or 'shaky limbs'. Typically, anxiety is a response to stress but individuals who suffer from anxiety disorders tend to feel these unwanted emotions all the time. This can seriously affect their performance in physical activities, work, school or friendships.
* Triggers for these anxiety disorders can stem from wide range of factors such as medical conditions, the surrounding environment and genetics. There are many different types of anxiety disorders. These include Generalized Anxiety Disorder, Social Anxiety Disorders, Panic Disorders, Separation Anxiety Disorder and Agoraphobia. There are many treatment options available for anxiety disorders including medication, behavior therapy and psychotherapy.


##### **Rationale**
* The treatment of anxiety disorders is being transformed by Virtual Reality as it can simulate real-world scenarios in a controlled environment that can be immerse and therapeutic to individuals with anxiety disorders. VR exposure therapy allows individuals to be exposed to situations that can trigger their anxiety. Through consistent sessions the individual can be desensitized to these triggers which can allow traditional cognitive-behavioral therapy. The integration of Virtual Reality into therapeutic practices shows that it has the potential to positively change the treatments for anxiety disorders.

##### **Hypothesis**
* Is traditional Cognitive Behavioral Therapy (CBT) more effective
than Vr-Based therapy?
  H0 : μ1 = μ2 or μ1 - μ2 = 0.
  Ha : μ1 > μ2 or μ1 − μ2 > 0.


### 5 - **Method** (20M)
##### **Participants**
* There was a grand total of 180 participants for this experiment. 96 were male while 84 were female. These 180 participants were all randomly sampled from a clinic's client list. All 180 participants were between the ages of 18-40 years old.
* The participants were split into two groups:
* The Control Group: Traditional CBT, no Virtual Reality involved, 48 males and 42 females.
* The Experimental Group: VR-Based Therapy, 48 Males and 42 Female.
* All the participants were undergoing treatment for Generalised Anxiety Disorder.

##### **Design**
* This study would be a experimental design study. We step in and apply Vr-based therapy to one of the participant groups and not to the other hence experimental.

##### **Materials**
* The materials needed are the Participants, Vr Equipment and CBT method equipment. There are also some variables age, gender and GAD measurements. 

##### **Procedure**
* The procedure of the experiment was as follows:
* Each group (Control and Experimental) were subjected to 12 weeks of therapy treatment with 50 minutes allocated to each session. During these sessions, the patients either went through traditional CBT or VR-Based therapy. Each patient gave a measurement (on a scale of 0-21 for GAD and 20-80 for STAI) of how severe the anxiety they experienced was. They had to self-report how they were feeling. Measurements were collected at the start and end of the experiment.
      
### 6 - **Results** (40M)
##### **Descriptive Statistics**
* FILL THIS OUT - ZAK

##### **Inferential Statistics**
CPostGAD <- clean_Control$posttrial_GAD
sampCPostGAD <- sample(CPostGAD, 20)
hist(sampCPostGAD,
main = "Histogram of Control Post-Trial GAD Scores",
xlab = "Post-Trial GAD Scores",
)
<!-- Above is: Random Sample of 20 from patients in the control group after undergoing treatment for GAD -->

CPreGAD <- clean_Control$pretrial_GAD
sampCPreGAD <- sample(CPreGAD, 20)
hist(sampCPreGAD,
main = "Histogram of Control Pre-Trial GAD Scores",
xlab = "Pre-Trial GAD Scores",
)
<!-- Above is: Random Sample of 20 from patients in the control group before undergoing treatment for GAD -->

CPostSTAI <- clean_Control$posttrial_STAI
sampCPostSTAI <- sample(CPostSTAI, 20)
hist(sampCPostSTAI,
main = "Histogram of Control Post-Trial STAI Scores",
xlab = "Post-Trial STAI Scores",
)
<!-- Above is: Random Sample of 20 from patients in the control group after undergoing treatment for STAI -->

CPreSTAI <- clean_Control$pretrial_STAI
sampCPreSTAI <- sample(CPreSTAI, 20)
hist(sampCPreSTAI,
main = "Histogram of Control Pre-Trial STAI Scores",
xlab = "Pre-Trial STAI Scores",
)
<!-- Above is: Random Sample of 20 from patients in the control group before undergoing treatment for STAI -->

EPostGAD <- clean_Experimental$posttrial_GAD
sampEPostGAD <- sample(EPostGAD, 20)
hist(sampEPostGAD,
main = "Histogram of Experimental Post-Trial GAD Scores",
xlab = "Post-Trial GAD Scores",
)
<!-- Above is: Random Sample of 20 from patients in the Experimental group after undergoing treatment for GAD -->

EPreGAD <- clean_Experimental$pretrial_GAD
sampEPreGAD <- sample(EPreGAD, 20)
hist(sampEPreGAD,
main = "Histogram of Experiemtnal Pre-Trial GAD Scores",
xlab = "Pre-Trial GAD Scores",
)
<!-- Above is: Random Sample of 20 from patients in the Experimental group before undergoing treatment for GAD -->

EPostSTAI <- clean_Experimental$posttrial_STAI
sampEPostSTAI <- sample(EPostSTAI, 20)
hist(sampEPostSTAI,
main = "Histogram of Experiemtnal Post-Trial STAI Scores",
xlab = "Post-Trial STAI Scores",
)
<!-- Above is: Random Sample of 20 from patients in the Experimental group after undergoing treatment for STAI -->

EPreSTAI <- clean_Experimental$pretrial_STAI
sampEPreSTAI <- sample(EPreSTAI, 20)
hist(sampEPreSTAI,
main = "Histogram of Experiemtnal Pre-Trial STAI Scores",
xlab = "Pre-Trial STAI Scores",
)
<!-- Above is: Random Sample of 20 from patients in the Experimental group before undergoing treatment for STAI -->
<!-- REFERENCE: https://bookdown.org/mrenna/statbook/statistical-inference.html -->

##### **Statistical Tests**
shapiro.test(posttrialGAD_Control$posttrial_GAD)
shapiro.test(posttrialSTAI_Control$posttrial_STAI)
shapiro.test(Experimental$posttrial_GAD)
shapiro.test(posttrialSTAI_Experimental$posttrial_STAI)
####The Hypothesis Test:
qplot(posttrialGAD_Control$posttrial_GAD, 
geom = "histogram")
qplot(posttrialSTAI_Experimental$posttrial_STAI, geom = "histogram")

controlGADmean <- mean(posttrialGAD_Control$posttrial_GAD)

t.test(Experimental$posttrial_GAD, mu = controlGADmean)

controlSTAImean <- mean(posttrialSTAI_Control$posttrial_STAI)

t.test(posttrialSTAI_Experimental$posttrial_STAI, mu = controlSTAImean)
<!-- Reference: https://data-flair.training/blogs/hypothesis-testing-in-r/
     https://www.youtube.com/watch?v=oNpfjcIf2Es 
     https://www.statology.org/r-mean-of-column/ -->
##### **Magnitude and Direction of Results**
* FILL THIS OUT - LEE
      
### 7 - **Discussion** (10M)
##### **Outline Findings and Relation To The Hypothesis**
* FILL THIS OUT - LEE

##### **Limitations (if confounding variables are clearly identified by your group)**
* FILL THIS OUT - ZAK
      
### 8 - **References** (2.5M)
* FILL THIS OUT - LEE/ZAK




